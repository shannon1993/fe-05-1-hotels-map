<!DOCTYPE html>

<html>
<head>
  <title>app.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>app.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * Las Vegas Diamond Hotels Map App
 * @namespace {object} app
 */</span>
<span class="hljs-keyword">var</span> app = app || {};


<span class="hljs-comment">/**
 * Callback for Google Maps. Runs after the maps api is loaded.
 *
 * @function app.init
 * @memberof app
 */</span>
app.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    app.model = <span class="hljs-keyword">new</span> app.Hotel();
    app.vm = <span class="hljs-keyword">new</span> app.ViewModel();
    app.hv = <span class="hljs-keyword">new</span> app.HotelView();
    app.mv = <span class="hljs-keyword">new</span> app.MapView();</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Get the hotel data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    app.model.init();</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Init Hotel View click event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    app.hv.init();</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Activate Knockout bindings on the ViewModel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    ko.applyBindings(app.vm);
};


<span class="hljs-comment">/**
 * Callback for onerror. If a script resource has an error, then a message is displayed.
 *
 * @function app.errorHandler
 * @memberof app
 */</span>
app.errorHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
    <span class="hljs-keyword">var</span> m = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'map'</span>);
    m.innerHTML = <span class="hljs-string">'There was an error loading the '</span> + x + <span class="hljs-string">' script.'</span>;
};


<span class="hljs-comment">/**
 * Hotel
 * @name app.Hotel
 * @class Hotel
 * @memberof app
 */</span>
app.Hotel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-meta">
    'use strict'</span>;

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

    self.hotels = ko.observableArray();
    self.yelp = {};

    <span class="hljs-comment">/**
     * @typedef Hotels
     * @type Object
     * @property {string} name - Name of hotel
     * @property {string} id - Yelp business ID
     * @property {object} location - Hotel coordinates
     * @property {number} location.lat - Latitude
     * @property {number} location.lng - Longitude
     * @property {number} diamonds - Diamond rating of hotel
     */</span>

    <span class="hljs-comment">/**
     * Retrieves the hotels json from Firebase server.
     *
     * @function app.Hotel.init
     * @memberof app.Hotel
     * @see {@link https://www.firebase.com/docs/web/guide/retrieving-data.html#section-reading-once}
     * @see {@link https://www.firebase.com/docs/web/api/query/once.html}
     * @returns {Hotels} - Hotel data in json notation
     */</span>
    self.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> hotelsRef;
        <span class="hljs-keyword">var</span> hotelsJSON;
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> hotel = [];
        <span class="hljs-keyword">var</span> length = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Start the 10 second timer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.reqTimeout();

        hotelsRef = <span class="hljs-keyword">new</span> Firebase(<span class="hljs-string">'https://crackling-heat-3113.firebaseio.com'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Read the data only once</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        hotelsRef.once(<span class="hljs-string">'value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dataSnapshot</span>) </span>{

            self.yelp = dataSnapshot.child(<span class="hljs-string">'yelp'</span>).val();

            hotelsJSON = dataSnapshot.child(<span class="hljs-string">'hotels'</span>).val();</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Store all the hotel data in app.Hotel.hotels</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            length = hotelsJSON.length;
            <span class="hljs-keyword">for</span> (i; i &lt; length; i++) {
                hotel = hotelsJSON[i];
                hotel.content = <span class="hljs-literal">null</span>;
                hotel.tweets = <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Save each hotel into a Knockout Observable Array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                self.hotels.push(hotel);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Initialize the map with the hotels</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            app.vm.init();

        }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">errorObject</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Called when client does not have permission to read this data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> errMsg = <span class="hljs-string">'Could not load hotel data. The read failed with error code: '</span>;
                errMsg += errorObject.code + <span class="hljs-string">'. Please contact the webmaster.'</span>;
            <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'map'</span>).innerHTML = errMsg;
        });
    }; <span class="hljs-comment">// init</span>

    <span class="hljs-comment">/**
     * Timer that displays an error message if map has not loaded.
     *
     * @function app.Hotel.reqTimeout
     * @memberof app.Hotel
     */</span>
    self.reqTimeout = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> m = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'map'</span>);
        <span class="hljs-keyword">var</span> errMsg = <span class="hljs-string">'Map request timed out. Check your connection and refresh the page.'</span>;
        setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Check to see if the map is loaded</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span>(m.children[<span class="hljs-number">0</span>].nodeName === <span class="hljs-string">'FIGCAPTION'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Display error message if no map found</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>               m.innerHTML = errMsg;
            }
        }, <span class="hljs-number">10000</span>);
    }; <span class="hljs-comment">// reqTimeout</span>

}; <span class="hljs-comment">// Hotel</span>


<span class="hljs-comment">/**
 * ViewModel
 * @name app.ViewModel
 * @class ViewModel
 * @memberof app
 */</span>
app.ViewModel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-meta">
    'use strict'</span>;

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

    self.hotelList = ko.observableArray();
    self.filterList = ko.observableArray();
    self.filterText = ko.observable(<span class="hljs-string">''</span>);
    self.ratingsChecked = ko.observableArray();
    self.ratings = ko.observableArray([
        {ratingValue: <span class="hljs-number">5</span>, icon: <span class="hljs-string">'aaaaa'</span>, color: <span class="hljs-string">'red'</span>},
        {ratingValue: <span class="hljs-number">4</span>, icon: <span class="hljs-string">'aaaa'</span>, color: <span class="hljs-string">'yellow'</span>},
        {ratingValue: <span class="hljs-number">3</span>, icon: <span class="hljs-string">'aaa'</span>, color: <span class="hljs-string">'green'</span>},
        {ratingValue: <span class="hljs-number">2</span>, icon: <span class="hljs-string">'aa'</span>, color: <span class="hljs-string">'purple'</span>},
    ]);

    <span class="hljs-comment">/**
     * @function app.ViewModel.getRatings
     * @memberof app.ViewModel
     * @returns {array} - List of diamond rating value, icon, and color
     */</span>
    self.getRatings = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> self.ratings();
    };

    <span class="hljs-comment">/**
     * @function app.ViewModel.nameSort
     * @memberof app.ViewModel
     * @returns {array} - Alphabetically sorted list of hotel names
     */</span>
    self.nameSort = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left, right</span>) </span>{
        <span class="hljs-keyword">return</span> left.name == right.name ? <span class="hljs-number">0</span> : (left.name &lt; right.name ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>);
    };

    <span class="hljs-comment">/**
     * @function app.ViewModel.getHotels
     * @memberof app.ViewModel
     * @returns {array} - An array of objects for each hotel
     */</span>
    self.getHotels = ko.computed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Unwrap the observable to return an array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> hotelArray = app.model.hotels();</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Sort the array by hotel name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        hotelArray.sort(self.nameSort);

        <span class="hljs-keyword">return</span> hotelArray;
    });

    <span class="hljs-comment">/**
     * @function app.ViewModel.getHotelsLength
     * @memberof app.ViewModel
     * @returns {number} - The length of the hotels array
     */</span>
    self.getHotelsLength = ko.computed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> app.model.hotels().length;
    });

    <span class="hljs-comment">/**
     * @function app.ViewModel.getKeys
     * @memberof app.ViewModel
     * @returns {object} - Yelp API keys
     */</span>
    self.getKeys = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> app.model.yelp;
    };

    <span class="hljs-comment">/**
     * Saves the list of hotels and initializes the map.
     *
     * @function app.ViewModel.init
     * @memberof app.ViewModel
     */</span>
    self.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        self.hotelList(self.getHotels());
        app.mv.initMap();
    };

    <span class="hljs-comment">/**
     * Slides in the filter menu and resizes the map.
     *
     * @function app.ViewModel.slideIn
     * @memberof app.ViewModel
     */</span>
    self.slideIn = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        app.hv.slideInLeft();
        google.maps.event.trigger(app.mv.map,<span class="hljs-string">'resize'</span>);
    };

    <span class="hljs-comment">/**
     * Slides out the filter menu, resizes the map, and centers the map on the marker.
     * If the screen height is greater than 400px, it will pan the map down 120px to make room for the infoWindow.
     *
     * @function app.ViewModel.slideOut
     * @memberof app.ViewModel
     */</span>
    self.slideOut = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        app.hv.slideOutLeft();
        google.maps.event.trigger(app.mv.map,<span class="hljs-string">'resize'</span>);
        app.mv.map.setCenter(app.mv.currentLocation);
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.screen.height &gt; <span class="hljs-number">400</span>) app.mv.map.panBy(<span class="hljs-number">0</span>, <span class="hljs-number">-120</span>);
    };

    <span class="hljs-comment">/**
     * Prevents the page from refreshing when the &lt;ENTER&gt; key is pressed.
     *
     * @function app.ViewModel.noEnter
     * @memberof app.ViewModel
     * @returns {boolean} - False
     */</span>
    self.noEnter = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, event</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Prevent form submission</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    };

    <span class="hljs-comment">/**
     * Runs when a hotel is selected in the list view.
     *
     * @function app.ViewModel.gotoHotel
     * @memberof app.ViewModel
     */</span>
    self.gotoHotel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Re-center the map on the marker that was clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        app.mv.map.setCenter(hotel.location);</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Pan down 120px (keeps tall infoWindow from getting cutoff)
Do not pan if in landscape mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.screen.height &gt; <span class="hljs-number">400</span>) app.mv.map.panBy(<span class="hljs-number">0</span>, <span class="hljs-number">-120</span>);

        app.mv.infoWindow.close();</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Manually trigger the click event for the marker</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        google.maps.event.trigger(hotel.marker, <span class="hljs-string">'click'</span>);
    };

    <span class="hljs-comment">/**
     * Toggles diamond rating checkbox, and filters hotels displayed by rating.
     *
     * @function app.ViewModel.filterRatings
     * @memberof app.ViewModel
     */</span>
    self.filterRatings = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, event</span>) </span>{
        self.hotelDisplay();</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Return true to toggle checkbox</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    };

    <span class="hljs-comment">/**
     * Displays the Diamond Rating Definitions.
     *
     * @function app.ViewModel.open
     * @memberof app.ViewModel
     */</span>
    self.open = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        app.hv.openInfo();
    };

    <span class="hljs-comment">/**
     * Hides the Diamond Rating Definitions.
     *
     * @function app.ViewModel.close
     * @memberof app.ViewModel
     */</span>
    self.close = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        app.hv.closeInfo();
    };

    <span class="hljs-comment">/**
     * Real time filtering of hotels displayed in the list and map.
     *
     * @function app.ViewModel.hotelDisplay
     * @memberof app.ViewModel
     * @returns {object} - Filtered list of hotels
     */</span>
    self.hotelDisplay = ko.computed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> result = <span class="hljs-number">-1</span>;
        <span class="hljs-keyword">var</span> temp = [];
        <span class="hljs-keyword">var</span> query = self.filterText().toLowerCase();
        <span class="hljs-keyword">var</span> rlength = self.ratingsChecked().length;
        <span class="hljs-keyword">var</span> diamond = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> match = <span class="hljs-number">-1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Reset the twitter ticker</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'twitter'</span>).innerHTML = <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Copy the original hotel list array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.filterList(self.hotelList());

        <span class="hljs-keyword">if</span> (!query &amp;&amp; rlength &lt;= <span class="hljs-number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Make all the hotel markers visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            self.filterList().forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel, index</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Prevents error if marker is not set yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span>(hotel.marker) hotel.marker.setVisible(<span class="hljs-literal">true</span>);
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Return all the hotels</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> self.filterList;
        } <span class="hljs-keyword">else</span> {
            self.filterList().forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel, index</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Check if the query matches with the hotel name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                result = hotel.name.toLowerCase().indexOf(query);
                diamond = hotel.diamonds;</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Ratings check</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span>(rlength &gt; <span class="hljs-number">0</span>)
                    match = self.ratingsChecked.indexOf(diamond);
                <span class="hljs-keyword">else</span>
                    match = <span class="hljs-number">0</span>;

                <span class="hljs-keyword">if</span>(result &gt;= <span class="hljs-number">0</span> &amp;&amp; match &gt;= <span class="hljs-number">0</span>) {
                    hotel.marker.setVisible(<span class="hljs-literal">true</span>);
                    temp.push(hotel);
                } <span class="hljs-keyword">else</span> {
                    hotel.marker.setVisible(<span class="hljs-literal">false</span>);
                    app.mv.infoWindow.close();
                }
            }); <span class="hljs-comment">// forEach</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Save the filtered hotels back to the ko observable array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            self.filterList(temp);

            <span class="hljs-keyword">return</span> self.filterList;
        } <span class="hljs-comment">// else</span>
    }); <span class="hljs-comment">// hotelDisplay</span>

}; <span class="hljs-comment">// ViewModel</span>


<span class="hljs-comment">/**
 * HotelView
 * @name app.HotelView
 * @class HotelView
 * @memberof app
 */</span>
app.HotelView = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-meta">
    'use strict'</span>;

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

    self.slide = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'slide'</span>);
    self.animateIn = <span class="hljs-string">'animated slideInLeft no-overlay'</span>;
    self.animateOut = <span class="hljs-string">'animated fadeOutLeft overlay'</span>;
    self.h3 = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'h3'</span>);
    self.def = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'definitions'</span>);

    <span class="hljs-comment">/**
     * Updates the class property to slide the menu in.
     *
     * @function app.HotelView.slideInLeft
     * @memberof app.HotelView
     */</span>
    self.slideInLeft = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        self.slide.className = self.animateIn;
    };

    <span class="hljs-comment">/**
     * Updates the class property to slide the menu out.
     *
     * @function app.HotelView.slideOutLeft
     * @memberof app.HotelView
     */</span>
    self.slideOutLeft = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        self.slide.className = self.animateOut;
    };

    <span class="hljs-comment">/**
     * Adds 'block' to display property.
     *
     * @function app.HotelView.openInfo
     * @memberof app.HotelView
     */</span>
    self.openInfo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        self.def.style.display = <span class="hljs-string">'block'</span>;
    };

    <span class="hljs-comment">/**
     * Removes 'block' from display property.
     *
     * @function app.HotelView.closeInfo
     * @memberof app.HotelView
     */</span>
    self.closeInfo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        self.def.style.display = <span class="hljs-string">''</span>;
    };

    <span class="hljs-comment">/**
     * Toggles arrow icon and toggles display of the section under the header.
     *
     * @function app.HotelView.toggleDisplay
     * @memberof app.HotelView
     */</span>
    self.toggleDisplay = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">headElem, iconClass</span>) </span>{
        <span class="hljs-keyword">if</span> (iconClass != <span class="hljs-string">'icons icon-down'</span>) {
            iconClass  = <span class="hljs-string">'icons icon-down'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Show the section under the heading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            headElem.nextElementSibling.style.display = <span class="hljs-string">'block'</span>;
        } <span class="hljs-keyword">else</span> {
            iconClass = <span class="hljs-string">'icons icon-right'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Hide the section under the heading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            headElem.nextElementSibling.style.display = <span class="hljs-string">'none'</span>;
        }

        <span class="hljs-keyword">return</span> iconClass;
    };

    <span class="hljs-comment">/**
     * Updates the class property for the icon inside the header.
     *
     * @function app.HotelView.setIcon
     * @memberof app.HotelView
     */</span>
    self.setIcon = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> elem;</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Fix for when the triangle icon is clicked inside the h3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span>(e.target.nodeName === <span class="hljs-string">'H3'</span>) {
            elem = e.target;
        } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Traverse up the DOM one level</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            elem = e.target.parentNode;
        }

        elem.firstChild.className = self.toggleDisplay(elem, elem.firstChild.className);
    };

    <span class="hljs-comment">/**
     * Creates click event listeners for each h3 heading.
     *
     * @function app.HotelView.init
     * @memberof app.HotelView
     */</span>
    self.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> len = self.h3.length;

        <span class="hljs-keyword">for</span>(i; i &lt; len; i++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Add a click event for each h3 heading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            self.h3[i].addEventListener(<span class="hljs-string">'click'</span>, self.setIcon, <span class="hljs-literal">false</span>);
        } <span class="hljs-comment">// for</span>
    };

}; <span class="hljs-comment">// HotelView</span>


<span class="hljs-comment">/**
 * MapView
 * @name app.MapView
 * @class MapView
 * @memberof app
 */</span>
app.MapView = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-meta">
    'use strict'</span>;

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

    self.infoWindow = <span class="hljs-literal">null</span>;
    self.currentLocation = <span class="hljs-literal">null</span>;
    self.currentMapCenter = <span class="hljs-literal">null</span>;
    self.originalMapCenter = {lat: <span class="hljs-number">36.1049534</span>, lng: <span class="hljs-number">-115.1724043</span>};
    self.mapDiv = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'map'</span>);
    self.mapOptions = {
        disableDefaultUI: <span class="hljs-literal">true</span>,
        center: self.originalMapCenter,
        zoom: <span class="hljs-number">15</span>,
        zoomControl: <span class="hljs-literal">true</span>,
        zoomControlOptions: {
            position: google.maps.ControlPosition.RIGHT_TOP
        }
    };
    self.preload = <span class="hljs-string">'&lt;div class="preload"&gt;Loading...&lt;div class="spin"&gt;&lt;/div&gt;&lt;/div&gt;'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Source: <a href="https://sites.google.com/site/gmapsdevelopment/">https://sites.google.com/site/gmapsdevelopment/</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    self.markerUrl = <span class="hljs-string">'http://maps.google.com/mapfiles/ms/icons/'</span>;
    self.markerColors = [<span class="hljs-string">'pink'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'purple'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'yellow'</span>, <span class="hljs-string">'red'</span>];

    <span class="hljs-comment">/**
     * Displays a Google Map and adds resize event listeners.
     *
     * @function app.MapView.init
     * @memberof app.MapView
     * @see {@link https://developers.google.com/maps/documentation/javascript/reference}
     */</span>
    self.initMap = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Create the map</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.map = <span class="hljs-keyword">new</span> google.maps.Map(self.mapDiv, self.mapOptions);</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Create the info window that will be re-used by each marker</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.infoWindow = <span class="hljs-keyword">new</span> google.maps.InfoWindow();</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Create the markers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.createMarkers();</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Trigger map resize if the window changes size</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        google.maps.event.addDomListener(<span class="hljs-built_in">window</span>, <span class="hljs-string">'resize'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            google.maps.event.trigger(self.map, <span class="hljs-string">'resize'</span>);
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Update center of the map on resize</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        google.maps.event.addListener(self.map, <span class="hljs-string">'resize'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            self.currentMapCenter = self.map.getCenter();
            self.map.setCenter(self.currentMapCenter);
        });
    }; <span class="hljs-comment">// initMap</span>

    <span class="hljs-comment">/**
     * Creates map markers.
     *
     * @function app.MapView.createMarkers
     * @memberof app.MapView
     */</span>
    self.createMarkers = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> hotel = {};
        <span class="hljs-keyword">var</span> allHotels = app.vm.getHotels();
        <span class="hljs-keyword">var</span> length = app.vm.getHotelsLength();

        <span class="hljs-keyword">for</span> (c; c &lt; length; c++) {
            hotel = allHotels[c];</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Marker color corresponds to diamond rating</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            hotel.color = self.markerColors[hotel.diamonds];</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Add hotel markers to the map</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            hotel.marker = <span class="hljs-keyword">new</span> google.maps.Marker({
                map: self.map,
                position: hotel.location,
                title: hotel.name,
                animation: <span class="hljs-literal">null</span>,
                visible: <span class="hljs-literal">true</span>,
                icon:  self.markerUrl + hotel.color + <span class="hljs-string">'.png'</span>
            }); <span class="hljs-comment">// marker</span>

            self.setInfoWin(hotel);
        } <span class="hljs-comment">// for</span>
    }; <span class="hljs-comment">// createMarkers</span>

    <span class="hljs-comment">/**
     * Sets the animation and icon properties for the map marker.
     *
     * @function app.MapView.animateMarker
     * @memberof app.MapView
     */</span>
    self.animateMarker = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Animate the marker</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        hotel.marker.setAnimation(google.maps.Animation.BOUNCE);</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Display the dot version of the marker</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        hotel.marker.icon = self.markerUrl + hotel.color + <span class="hljs-string">'-dot.png'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Animate the marker for 2.1 seconds</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            hotel.marker.setAnimation(<span class="hljs-literal">null</span>);
            hotel.marker.icon = self.markerUrl + hotel.color + <span class="hljs-string">'.png'</span>;
        }, <span class="hljs-number">2100</span>);
    }; <span class="hljs-comment">// animateMarker</span>

    <span class="hljs-comment">/**
     * Gets the content or reads already set content for the infoWindow.
     * Sets currentLocation, and creates a click event listener.
     * Gets the hotel's recent tweets and inserts them into the page.
     *
     * @function app.MapView.setInfoWin
     * @memberof app.MapView
     */</span>
    self.setInfoWin = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Open the infoWindow when a marker is clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        google.maps.event.addListener(hotel.marker, <span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span>(!hotel.content) {
                self.infoWindow.setContent(self.preload);
                self.getContent(hotel);
            }
            <span class="hljs-keyword">else</span>
                self.infoWindow.setContent(hotel.content);

            self.infoWindow.open(self.map, hotel.marker);
            self.animateMarker(hotel);
            self.currentLocation = hotel.location;

            <span class="hljs-keyword">if</span>(!hotel.tweets)
                self.getTweets(hotel);
            <span class="hljs-keyword">else</span>
                self.displayTweets(hotel.tweets);
        });

    }; <span class="hljs-comment">// setInfoWin</span>

    <span class="hljs-comment">/**
     * Calls the Yelp API via JSONP AJAX and sets the content of the infoWindow.
     *
     * @function app.MapView.getContent
     * @memberof app.MapView
     */</span>
    self.getContent = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel</span>) </span>{
        <span class="hljs-comment">/**
         * Generates a random number and returns it as a string for OAuthentication
         * @return {string}
         */</span>
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nonce_generate</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">return</span> (<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">1e12</span>).toString());
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Proof of concept of how to connect to an oAuth API with JS
For real world use youâ€™d want a backend that hides your keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> yelpUrl = <span class="hljs-string">'http://api.yelp.com/v2/business/'</span> + hotel.id;
        <span class="hljs-keyword">var</span> auth = app.vm.getKeys();
        <span class="hljs-keyword">var</span> parameters = {
          oauth_consumer_key: auth.CONSUMER_KEY,
          oauth_token: auth.TOKEN,
          oauth_nonce: nonce_generate(),
          oauth_timestamp: <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Date</span>.now() / <span class="hljs-number">1000</span>),
          oauth_signature_method: <span class="hljs-string">'HMAC-SHA1'</span>,
          oauth_version: <span class="hljs-string">'1.0'</span>,
          callback: <span class="hljs-string">'cb'</span>
        };
        <span class="hljs-keyword">var</span> encodedSignature = oauthSignature.generate(<span class="hljs-string">'GET'</span>,
                                                        yelpUrl,
                                                        parameters,
                                                        auth.CONSUMER_SECRET,
                                                        auth.TOKEN_SECRET);
        parameters.oauth_signature = encodedSignature;

        $jsonp.send(yelpUrl, {
            callbackName: <span class="hljs-string">'cb'</span>,
            data: parameters,
            onSuccess: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>)</span>{
                hotel.content = self.getTemplate(hotel.name,
                                                 hotel.diamonds,
                                                 json.image_url,
                                                 json.snippet_text,
                                                 json.url);
                self.infoWindow.setContent(hotel.content);
            },
            onTimeout: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
                hotel.content = <span class="hljs-literal">null</span>;
                self.infoWindow.setContent(<span class="hljs-string">'Error retrieving Yelp data.&lt;br&gt;Please try again.'</span>);
            },
                timeout: <span class="hljs-number">5</span>
        });

    }; <span class="hljs-comment">// getContent</span>

    <span class="hljs-comment">/**
     * Matches the icon to diamond rating and formats html for the hotel image and review snippet.
     *
     * @function app.MapView.getTemplate
     * @memberof app.MapView
     * @returns {string} - HTML containing hotel name, diamond rating, image, and review.
     */</span>
    self.getTemplate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, diamonds, image, review, url</span>) </span>{
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> d = app.vm.getRatings();
        <span class="hljs-keyword">var</span> dlength = d.length;
        <span class="hljs-keyword">var</span> template = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">var</span> icon = <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Match the diamond rating to the icon text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">for</span>(i; i &lt; dlength; i++) {
            <span class="hljs-keyword">if</span>(d[i].ratingValue === diamonds) {
                icon = d[i].icon;
                <span class="hljs-keyword">break</span>;
            }
        }

        template = <span class="hljs-string">'&lt;h4&gt;'</span> + name + <span class="hljs-string">'&lt;/h4&gt;'</span>;
        template += <span class="hljs-string">'&lt;i class="diamonds small"&gt;'</span> + icon + <span class="hljs-string">'&lt;/i&gt;'</span>;
        template += <span class="hljs-string">'&lt;div class="gm-info-container"&gt;'</span>;
        template += <span class="hljs-string">'  &lt;div class="gm-info-image"&gt;&lt;img src="'</span> + image + <span class="hljs-string">'" alt="'</span> + name + <span class="hljs-string">'"&gt;&lt;/div&gt;'</span>;
        template += <span class="hljs-string">'  &lt;div class="gm-info-text"&gt;'</span>;
        template +=    <span class="hljs-string">'&lt;img src="images/yelp_reviews.png" alt="Yelp Reviews"&gt;&lt;br&gt;'</span>;
        template +=    review + <span class="hljs-string">' &lt;a href="'</span> + url + <span class="hljs-string">'"&gt;read more&lt;/a&gt;'</span>;
        template += <span class="hljs-string">'  &lt;/div&gt;'</span>;
        template += <span class="hljs-string">'&lt;/div&gt;'</span>;

        <span class="hljs-keyword">return</span> template;
    }; <span class="hljs-comment">// getTemplate</span>

    self.getTweets = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">hotel</span>) </span>{
        <span class="hljs-keyword">var</span> twitter_api_wrapper = <span class="hljs-string">'http://topwidget.co/twitter/api.php'</span>;
        <span class="hljs-keyword">var</span> data = {
            <span class="hljs-string">"screen_name"</span>: hotel.twitter,
            <span class="hljs-string">"count"</span>: <span class="hljs-number">5</span>
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>url, method, data, success, fail</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        AJAX.request(twitter_api_wrapper, <span class="hljs-string">'GET'</span>, data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
            <span class="hljs-keyword">var</span> tweets = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> length = response.length;
            <span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">var</span> txt = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> img = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> id = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> url = <span class="hljs-string">'https://twitter.com/'</span> + hotel.twitter + <span class="hljs-string">'/status/'</span>;

            <span class="hljs-keyword">for</span>(t; t &lt; length; t++) {
                id = response[t].id_str;
                txt = response[t].text;
                img = response[t].user.profile_image_url;
                tweets += <span class="hljs-string">'&lt;li class="tweet"&gt;'</span>;
                tweets += <span class="hljs-string">'&lt;a href="'</span> + url + id + <span class="hljs-string">'" title="@'</span> + hotel.twitter + <span class="hljs-string">'" target="_blank"&gt;'</span>;
                tweets += <span class="hljs-string">'&lt;img src="'</span> + img + <span class="hljs-string">'" alt="@'</span> + hotel.twitter + <span class="hljs-string">'"&gt; '</span>;
                tweets += txt + <span class="hljs-string">'&lt;/a&gt;'</span>;
                tweets += <span class="hljs-string">'&lt;/li&gt;'</span>;
            } <span class="hljs-comment">// for</span>

            hotel.tweets = tweets;
            self.displayTweets(hotel.tweets);

        },<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            hotel.tweets = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.console) <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"AJAX request failed."</span>);
        });

    }; <span class="hljs-comment">// getTweets</span>

    self.displayTweets = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tweets</span>) </span>{
        <span class="hljs-keyword">var</span> twitter = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'twitter'</span>);
        twitter.innerHTML = tweets;
    }; <span class="hljs-comment">// displayTweets</span>

}; <span class="hljs-comment">// MapView</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
